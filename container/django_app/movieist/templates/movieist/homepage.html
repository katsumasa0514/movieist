{% extends 'movieist/base.html' %}

{% block content %}
<div class="main">
    <div class="container">
        <div class="main-top">
            <img src="" alt="">
            <div class="top-title">
                <h2>Movieist for contributor</h2>
                <p>投稿者のおすすめから見つける映画情報サイト >>></p>
            </div>
        </div>
        <div class="main-principal">
            <div class="topic">
                <a href="/movieist/search/topic">注目の投稿></a>
                {% for topic in topicData %}
                <div class="topic-review">
                    <div class="leftBox">
                        <img src="{{topic.image_path}}">
                        <a href="/movieist/overview/{{topic.movie_id}}">{{topic.title}}</a>
                    </div>
                    <div class="rightBox">
                        <div class="userAndEvaluation">
                            {% for user in topic.profile %}
                            <div class="user">
                                <img src="{{user.userPic.url}}" width="100" height="100" />
                                <a href="/movieist/reviewer/{{user.user_id}}">{{user.user.username}}</a>
                            </div>
                            {% endfor %}
                            <div class="evaluation">
                                <form topic="{% url 'homepage' %}" method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{topic.id}}">
                                    <input type="submit" name="good" value="GOOD">
                                </form>
                                <h3>{{topic.countgood}}</h3>
                                <form topic="{% url 'homepage' %}" method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{topic.id}}">
                                    <input type="submit" name="bad" value="BAD">
                                </form>
                                <h3>{{topic.countbad}}</h3>
                            </div>
                        </div>
                        <div class="comments">
                            <h3>{{topic.commentTitle}}</h3>
                            <p>{{topic.comment}}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="more-topic">
                <a href="/movieist/search/topic">もっと見る</a>
            </div>
            <div class="searchtitle">
                <a href="/movieist/search/allgenre">映画を探す></a>
                {% for search in searchData %}
                <div class="searchtitle-review">
                    <div class="leftBox">
                        <img src="{{search.image_path}}">
                        <a href="/movieist/overview/{{search.movie_id}}">{{search.title}}</a>
                    </div>
                    <div class="rightBox">
                        <div class="userAndEvaluation">
                            {% for user in search.profile %}
                            <div class="user">
                                <img src="{{user.userPic.url}}" width="100" height="100" />
                                <a href="/movieist/reviewer/{{user.user_id}}">{{user.user.username}}</a>
                            </div>
                            {% endfor %}
                            <div class="evaluation">
                                <form search="{% url 'homepage' %}" method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{search.id}}">
                                    <input type="submit" name="good" value="GOOD">
                                </form>
                                <h3>{{search.countgood}}</h3>
                                <form search="{% url 'homepage' %}" method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{search.id}}">
                                    <input type="submit" name="bad" value="BAD">
                                </form>
                                <h3>{{search.countbad}}</h3>
                            </div>
                        </div>
                        <div class="comments">
                            <h3>{{search.commentTitle}}</h3>
                            <p>{{search.comment}}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="more-searchtitle">
                <a href="/movieist/search/allgenre">もっと見る</a>
            </div>
            <div class="reviewer-ranking">
                <a href="/movieist/reviewer_ranking">レビュアーランキング></a>
                {% for ranking in rankingData %}
                <div class="ranking">
                    {% for profile in ranking.profile %}
                    <div class="user-info">
                        <div class="upside">
                            <div class="left-box">
                                <img src="{{profile.userPic.url}}" width="100" height="100" />
                                <a href="/movieist/reviewer/{{profile.user_id}}">{{profile.user.username}}</a>
                            </div>
                            <div class="right-box">
                                {% if follow.following != request.user.id %}
                                <form action="{% url 'homepage' %}" method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="follow" value="{{profile.user_id}}">
                                    <input type="submit" value="{{ranking.button}}">
                                </form>
                                {% endif %}
                            </div>
                        </div>
                        <div class="downside">
                            <div class="countFollower">
                                <h3>follower</h3>
                                <h3>{{ranking.countFollower}}</h3>
                            </div>
                            <p>{{profile.userComment}}</p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% for reviewed in ranking.reviewed %}
                <div class="reviewed">
                    <img src="{{reviewed.image_path}}">
                </div>
                {% endfor %}
                {% endfor %}
            </div>
            <div class="more-ranking">
                <a href="/movieist/reviewer_ranking">もっと見る</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}