{% extends 'movieist/base.html' %}
{% load static %}

{% block content %}
<div class="main" style="background-color: #fafafa;">
    <b-container style="padding: 0 5% 0 5%">
        <b-row align-v="end" style="position: relative;">
            <div>
                <b-card overlay img-src="https://picsum.photos/1024/400/?image=41" img-alt="Card Image"
                    text-variant="white">
                    <b-card-text style="position: absolute; padding: 10vw;">
                        <h1 style="font-size: calc(15px + 2vw); font-family: 'Anton', sans-serif; color: white;">
                            Movieist for
                            contributor
                        </h1>
                        <p style="font-size: calc(1px + 2vw); font-family: 'Noto Serif JP', sans-serif; color: white;">
                            ユーザーの投稿から観たい映画を見つけるサイト</p>
                    </b-card-text>
                </b-card>
            </div>
        </b-row>



        <div class="topic">
            <b-row style="padding: 5% 2% 2% 2%;">
                <b-link href="/movieist/search/topic" style="font-size: calc(10px + 1vw); color: #333;">
                    注目の投稿 >>></b-link>
            </b-row>
            {% for topic in topicData %}
            <b-card style="padding: 1vw;" no-body="true">
                <b-row>
                    <b-col cols="4" sm="3">
                        <b-img src="{{topic.image_path}}" fluid alt="Responsive image"></b-img>
                    </b-col>
                    <b-col cols="12" sm="9">
                        <b-row style="font-size: calc(13px + 0.7vw); padding: 5px 15px;">
                            <b-link href="/movieist/overview/{{topic.movie_id}}" style="color: #333; font-weight: 700;">
                                {{topic.title}}
                            </b-link>
                        </b-row>
                        {% for user in topic.profile %}
                        <b-row>
                            <b-col cols="12">
                                <b-avatar src="{{user.userPic.url}}" size="calc(40px + 1vw)"></b-avatar>
                                <b-link href="/movieist/reviewer/{{user.user_id}}"
                                    style="font-size: calc(12px + 0.3vw);">{{user.user.username}}
                                </b-link>
                            </b-col>
                            {% endfor %}
                        </b-row>
                        <b-row style="padding: 1vw;">
                            <b-col cols="12">
                                <star-rating :increment="0.5" v-model="{{topic.star}}" read-only="true"
                                    class="read-only">
                                </star-rating>
                            </b-col>
                        </b-row>
                        <b-card no-body="true" style="padding: 1vw;">
                            <b-row>
                                <b-col cols="12">
                                    <h6 style="font-weight: 700; font-size: calc(12px + 0.3vw);">{{topic.commentTitle}}
                                    </h6>
                                </b-col>
                                <b-col cols="12" style="font-size: calc(12px + 0.3vw);">
                                    <p>{{topic.comment}}</p>
                                </b-col>
                            </b-row>
                        </b-card>
                        <b-row>
                            <b-col cols="12" style="display: flex;">
                                <form topic="{% url 'homepage' %}" method="post"
                                    style="padding: 2px; text-align: right;">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{topic.id}}">
                                    <b-button variant="outline-dark" type="submit" name="good" value="GOOD"
                                        style="padding: 2px 5px 2px 5px;">
                                        <b-icon icon="hand-thumbs-up" aria-hidden="true"></b-icon>{{topic.countgood}}
                                    </b-button>
                                </form>
                                <form topic="{% url 'homepage' %}" method="post" style="padding: 2px;">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{topic.id}}">
                                    <b-button variant="outline-dark" type="submit" name="bad" value="BAD"
                                        style="padding: 2px 5px 2px 5px;">
                                        <b-icon icon="hand-thumbs-down" aria-hidden="true"></b-icon>{{topic.countbad}}
                                    </b-button>
                                </form>
                            </b-col>
                        </b-row>
                    </b-col>
                </b-row>
            </b-card>
            {% endfor %}
        </div>
        <div class="more-topic" style="text-align: center; color: #333; padding: 2%;">
            <b-button href="/movieist/search/topic" style="font-size: calc(12px + 0.3vw);">もっと見る ></b-button>
        </div>



        <div class="searchtitle">
            <b-row style="padding: 5% 2% 2% 2%;">
                <b-link href="/movieist/search/allgenre" style="font-size: calc(10px + 1vw); color: #333;">
                    映画を探す >>></b-link>
            </b-row>
            {% for search in searchData %}
            <b-card style="padding: 1vw; margin: 1vw;" no-body="true">
                <b-row>
                    <b-col cols="4" sm="3">
                        <b-img src="{{search.image_path}}" fluid alt="Responsive image"></b-img>
                    </b-col>
                    <b-col cols="12" sm="9">
                        <b-row style="font-size: calc(13px + 0.7vw); padding: 5px 15px;">
                            <b-link href="/movieist/overview/{{search.movie_id}}"
                                style="color: #333; font-weight: 700;">
                                {{search.title}}
                            </b-link>
                        </b-row>
                        {% for user in search.profile %}
                        <b-row>
                            <b-col cols="12">
                                <b-avatar src="{{user.userPic.url}}" size="calc(40px + 1vw)"></b-avatar>
                                <b-link href="/movieist/reviewer/{{user.user_id}}"
                                    style="font-size: calc(12px + 0.3vw);">{{user.user.username}}
                                </b-link>
                            </b-col>
                            {% endfor %}
                        </b-row>
                        <b-row style="padding: 1vw;">
                            <b-col cols="12">
                                <star-rating :increment="0.5" v-model="{{search.star}}" read-only="true"
                                    class="read-only">
                                </star-rating>
                            </b-col>
                        </b-row>
                        <b-card no-body="true" style="padding: 1vw;">
                            <b-row>
                                <b-col cols="12">
                                    <h6 style="font-weight: 700; font-size: calc(12px + 0.3vw);">{{search.commentTitle}}
                                    </h6>
                                </b-col>
                                <b-col cols="12" style="font-size: calc(12px + 0.3vw);">
                                    <p>{{search.comment}}</p>
                                </b-col>
                            </b-row>
                        </b-card>
                        <b-row>
                            <b-col cols="12" style="display: flex;">
                                <form search="{% url 'homepage' %}" method="post"
                                    style="padding: 2px; text-align: right;">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{search.id}}">
                                    <b-button variant="outline-dark" type="submit" name="good" value="GOOD"
                                        style="padding: 2px 5px 2px 5px;">
                                        <b-icon icon="hand-thumbs-up" aria-hidden="true"></b-icon>{{search.countgood}}
                                    </b-button>
                                </form>
                                <form search="{% url 'homepage' %}" method="post" style="padding: 2px;">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{search.id}}">
                                    <b-button variant="outline-dark" type="submit" name="bad" value="BAD"
                                        style="padding: 2px 5px 2px 5px;">
                                        <b-icon icon="hand-thumbs-down" aria-hidden="true"></b-icon>{{search.countbad}}
                                    </b-button>
                                </form>
                            </b-col>
                        </b-row>
                    </b-col>
                </b-row>
            </b-card>
            {% endfor %}
        </div>
        <div class="more-search" style="text-align: center; color: #333; padding: 2%;">
            <b-button href="/movieist/search/search" style="font-size: calc(12px + 0.3vw);">もっと見る ></b-button>
        </div>



        <div class="reviewer-ranking">
            <b-row style="padding: 5% 2% 2% 2%;">
                <b-link href="/movieist/reviewer_ranking" style="font-size: calc(10px + 1vw); color: #333;">
                    レビュアーランキング >>></b-link>
            </b-row>
            <b-row>
                {% for ranking in rankingData %}
                {% for profile in ranking.profile %}
                <b-col md="6">
                    <b-card no-body="true">
                        <b-card-body style="padding: 1vw 1.25rem;">
                            <b-row style="border: 1px black;">
                                <b-col cols="9" style="padding: 0 1vw;">
                                    <b-avatar src="{{profile.userPic.url}}" size="calc(40px + 1vw)">
                                    </b-avatar>
                                    <b-link href="/movieist/reviewer/{{profile.user_id}}"
                                        style="font-size: calc(12px + 0.3vw);">{{profile.user.username}}
                                    </b-link>
                                </b-col>
                                <b-col cols="3" style="text-align: center; padding: 0 1vw;">
                                    <span style="color: rgb(180, 180, 180); font-size: 1vw;">Followers</span>
                                    <h6>{{ranking.countFollower}}</h6>
                                </b-col>
                            </b-row>
                            <b-row>
                                <b-col cols="12">
                                    <span>{{profile.userComment}}</span>
                                </b-col>
                            </b-row>
                            {% if follow.following != request.user.id %}
                            <b-row>
                                <b-col cols="12">
                                    <form action="{% url 'homepage' %}" method="post">
                                        {% csrf_token %}
                                        <input type="hidden" name="follow" value="{{profile.user_id}}">
                                        <input type="submit" value="{{ranking.button}}">
                                    </form>
                                </b-col>
                            </b-row>
                            {% endif %}
                            <b-row>
                                <b-col cols="12">
                                    <b-carousel indicators controls="true" fade="true" :per-page="3" interval="10000">
                                        {% for reviewed in ranking.reviewed %}
                                        <img src="{{reviewed.image_path}}">
                                        <b-carousel-slide img-src="">
                                            <img src="{{reviewed.image_path}}">
                                        </b-carousel-slide>
                                        {% endfor %}
                                    </b-carousel>
                                </b-col>
                            </b-row>
                        </b-card-body>
                    </b-card>
                </b-col>
                {% endfor %}
                {% endfor %}
            </b-row>
        </div>
        <!--
        <a href="/movieist/reviewer_ranking">レビュアーランキング></a>
        {% for ranking in rankingData %}
        <div class="ranking">
            {% for profile in ranking.profile %}
            <div class="user-info">
                <div class="upside">
                    <div class="left-box">
                        <img src="{{profile.userPic.url}}" width="100" height="100" />
                        <a href="/movieist/reviewer/{{profile.user_id}}">{{profile.user.username}}</a>
                    </div>
                    <div class="right-box">
                        {% if follow.following != request.user.id %}
                        <form action="{% url 'homepage' %}" method="post">
                            {% csrf_token %}
                            <input type="hidden" name="follow" value="{{profile.user_id}}">
                            <input type="submit" value="{{ranking.button}}">
                        </form>
                        {% endif %}
                    </div>
                </div>
                <div class="downside">
                    <div class="countFollower">
                        <h3>follower</h3>
                        <h3>{{ranking.countFollower}}</h3>
                    </div>
                    <p>{{profile.userComment}}</p>
                </div>
            </div>
            {% endfor %}
        </div>
        {% for reviewed in ranking.reviewed %}
        <div class="reviewed">
            <img src="{{reviewed.image_path}}">
        </div>
        {% endfor %}
        {% endfor %}
        <div class="more-ranking">
            <a href="/movieist/reviewer_ranking">もっと見る</a>
        </div>
        -->
    </b-container>
</div>

{% endblock %}